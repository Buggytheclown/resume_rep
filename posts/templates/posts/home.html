{% extends 'posts/base.html' %}


{% block title %}
    Home
{% endblock %}

{#{% block content %}#}
{#{% for i in model_title %}#}
{#   <h2><a href="{{ i.get_absolute_url }}">{{ i.title }}</a> <small>{{ i.updated|timesince }} ago</small></h2>#}
{#    <p>{{ i.content|linebreaks|truncatechars:500 }}</p><br>#}
{#{% endfor %}#}
{#{% endblock %}#}


{% block active_home %}
    class='active'
{% endblock %}

{% block content %}
    {#    <div class="col-sm-8 blog-main col-sm-offset-2" style="margin-top: 50px">#}
    <div class="row">
        <div class="col-sm-4 col-sm-offset-4">

            <h1>Tidjei's blog</h1>
            <form method="GET" action="">
                <div class="input-group">
                    <input class="form-control" type="text" placeholder="Search for..." name="q"
                           value="{{ request.GET.q }}"/>
                <span class="input-group-btn">
                <input type="submit" class="btn btn-info" value="Search"/>
                    </span>
                </div>
            </form>
        </div>

        <div class="col-sm-6 col-sm-offset-4">
            {% if request.user.is_authenticated %}
                <a style="margin-top: 20px" href="{% url 'create' %}" class="btn btn-success" role="button">Create a
                    Post</a>
            {% else %}
                {#                <a style="margin-top: 20px" href="#" class="btn btn-danger" role="button">Create a#}
                {#                    Post</a>#}

                <button style="margin-top: 20px" type="button" class="btn btn-danger" data-toggle="modal"
                        data-target=".bs-example-modal-sm">
                    Create a Post
                </button>
                <div class="modal fade bs-example-modal-sm" tabindex="-1" role="dialog"
                     aria-labelledby="mySmallModalLabel">
                    <div class="modal-dialog modal-sm">
                        <div class="modal-content">
                            <div class="modal-header">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                        aria-hidden="true">&times;</span></button>
                                <h4 class="modal-title">Access error</h4>
                            </div>
                            <div class="modal-body">
                                <p> You must be <a href="{% url 'auth_login' %}"> logged in </a> to
                                    create a post.<br>
                                    Do you wanna <a href="{% url 'registration_register' %}">
                                        register?</a></p>
                            </div>
                            <div class="modal-footer">
                                <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
                            </div>
                        </div>
                    </div>
                </div>



            {% endif %}
        </div>
    </div>

    {% for i in model_title %}
        <div class="row" style="margin-top: 50px">

            <div class="col-sm-2">
                <form method="POST">{% csrf_token %}
                    <input hidden name="post_id" value="{{ i.id }}">
                    <input hidden name="user_plus" value="{{ request.user.id }}">
                    <input type="submit" class="btn btn-success" value="+">
                </form>

                <strong>Rating: {{ i.get_rating }}</strong>
                <br>

                <form method="POST">{% csrf_token %}
                    <input hidden name="post_id" value="{{ i.id }}">
                    <input hidden name="user_minus" value="{{ request.user.id }}">
                    <input type="submit" class="btn btn-danger" value="-">
                </form>
            </div>


            <div class="col-sm-10">
                <h3>{{ i.title }}</h3> <br>
                        <span><small>{{ i.updated|timesince }} ago</small>

                    <p>Author:<a href="{% url 'view_profile' i.user.id %}"> {{ i.user }} </a></p></span>


                <div class="thumbnail">
                    {% if i.image %}
                        <img src="{{ i.image.url }}" class="img-responsive"/>
                    {% endif %}

                    <div class="caption">
                        <p>{{ i.content|linebreaks|truncatechars:600 }}</p>
                        <p><a href="{{ i.get_absolute_url }}" class="btn btn-primary" role="button">View</a>
                            {% if request.user == i.user or request.user.is_superuser %}
                                <a href="{% url 'update' i.id %}" class="btn btn-info"
                                   role="button">Edit</a>
                                <a href="{% url 'delete' i.id %}" class="btn btn-warning" role="button">Delete</a>
                                </p>
                            {% endif %}
                    </div>
                </div>
            </div>
        </div>
    {% endfor %}



    <div class="row">
        <div class="col-sm-6 col-sm-offset-5">
            <div class="pagination">
    <span class="step-links">
        {% if model_title.has_previous %}
            <a href="?page={{ model_title.previous_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}
            {% endif %}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ model_title.number }} of {{ model_title.paginator.num_pages }}.
        </span>

        {% if model_title.has_next %}
            <a href="?page={{ model_title.next_page_number }}{% if request.GET.q %}&q={{ request.GET.q }}
            {% endif %}">next</a>
        {% endif %}
    </span>
            </div>
        </div>
    </div>
{% endblock %}